var GMap=function(){function e(e,t,s,a){var i=this;this.apiKey=e,this.target=t,this.mapOptions=s,this.callback=a,this.markers=[],this.openMarkers=[],this.addTag("https://maps.googleapis.com/maps/api/js?key="+this.apiKey,function(){i.initMap()})}return Object.defineProperty(e.prototype,"zoom",{set:function(e){this.map.setZoom(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"center",{set:function(e){var t=e.lat,s=e.lng;this.map.setCenter({lat:t,lng:s})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapType",{set:function(e){this.map.setMapTypeId(e)},enumerable:!0,configurable:!0}),e.prototype.initMap=function(){this.map=new google.maps.Map(this.target,this.mapOptions),this.map.setOptions({styles:[{featureType:"poi.business",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels.icon",stylers:[{visibility:"on"}]}]}),this.legenda(),this.clustify(),this.callback()},e.prototype.addTag=function(e,t){var s=document.createElement("script");s.type="text/javascript",s.src=e;var a=document.getElementsByTagName("script")[0];return a.parentNode.insertBefore(s,a),s.readyState?s.onreadystatechange=function(){"loaded"!==s.readyState&&"complete"!==s.readyState||(s.onreadystatechange=null,t())}:s.onload=function(){t()},s},e.prototype.getCor=function(e){var t,s="https://maps.googleapis.com/maps/api/geocode/json?address="+e+"&key="+this.apiKey,a=new XMLHttpRequest;return a.open("GET",s,!1),a.send(null),t=JSON.parse(a.responseText),t.results[0].geometry.location},e.prototype.marker=function(e){for(var t=0;t<this.markers.length;t++)if(this.markers[t].slug===e)return this.markers[t]},e.prototype.makeMarker=function(e,t,s,a,i){var r,n,l=this,o=e.lat,p=e.lng,y="h4",c="p",m="<a href="+i+">Read more.</a>",g=s?"<a href='"+i+"'><"+y+">"+t+"</"+y+"> </a><"+c+">"+s+"\n"+m+"</"+c+">":"<a href='"+i+"'><"+y+">"+t+"</"+y+"> </a>",h=this.marker(a),d=26,u={url:h.icon,scaledSize:new google.maps.Size(d,d),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,0)};return r=new google.maps.Marker({position:{lat:o,lng:p},map:this.map,title:t,icon:u}),h.items.push(r),this.cluster.addMarker(r),"none"===h.DOM.style.display&&(h.DOM.style.display="block"),n=new google.maps.InfoWindow({content:g}),r.addListener("click",function(){for(var e=0;e<l.openMarkers.length;e++)l.openMarkers[e].close(),l.openMarkers.splice(e,1);n.open(l.map,r),l.openMarkers.push(n)}),r},e.prototype.toggleCat=function(e){for(var t=0;t<this.marker(e).items.length;t++){var s=this.marker(e).items[t];s.getVisible()?s.setVisible(!1):s.setVisible(!0)}},e.prototype.getAllMarkers=function(){for(var e=[],t=0;t<this.markers.length;t++)for(var s=0;s<this.markers[t].items.length;s++)e.push(this.markers[t].items[s]);return e},e.prototype.clustify=function(){var e={url:"https://raw.githubusercontent.com/Noedel-Man/GMap/master/img/cluster.png",height:26,width:26,anchor:[0,0],textColor:"#ffffff",textSize:12};this.cluster=new MarkerClusterer(this.map,[],{minimumClusterSize:4,maxZoom:16,gridSize:30,averageCenter:!1,styles:[e,e,e]})},e.prototype.legenda=function(){this.legendaDOM=document.createElement("div");var e="24px";this.legendaDOM.style.position="absolute",this.legendaDOM.style.zIndex="1",this.legendaDOM.style.top="50px",this.legendaDOM.style.left="14px",this.legendaDOM.style.width=e,this.target.insertBefore(this.legendaDOM,this.target.firstChild)},e.prototype.addLegendaItem=function(e,t,s){var a=this,i="24px",r=document.createElement("div"),n=document.createElement("img"),l=document.createElement("span"),o=!0,p={slug:t,name:e,icon:s,DOM:r,items:[]};this.markers.push(p),r.style.marginTop="10px",r.style.cursor="pointer",r.style.display="none",r.style.position="relative",n.style.width=i,n.src=p.icon,r.style.filter="grayscale(10%)",r.style.webkitFilter="grayscale(10%)",n.style.opacity="0.8",l.style.position="absolute",l.style.transform="translateY(-50%)",l.style.top="50%",l.style.left="120%",l.style.opacity="0",l.style.fontStyle="italic",l.style.fontSize="0.9em",l.innerHTML=p.name,r.appendChild(n),r.appendChild(l),this.legendaDOM.appendChild(r),r.addEventListener("click",function(){a.toggleCat(t);var e=a.marker(t).items[0];e.getVisible()?(o=!0,r.style.filter="grayscale(10%)",r.style.webkitFilter="grayscale(10%)",n.style.opacity="0.8"):(o=!1,r.style.filter="grayscale(100%)",r.style.webkitFilter="grayscale(100%)",n.style.opacity="0.6")},!1),r.addEventListener("mouseenter",function(){r.style.filter="grayscale(0%)",r.style.webkitFilter="grayscale(0%)",n.style.opacity="1",l.style.opacity="1"},!1),r.addEventListener("mouseleave",function(){o?(r.style.filter="grayscale(10%)",r.style.webkitFilter="grayscale(10%)",n.style.opacity="0.8"):(r.style.filter="grayscale(100%)",r.style.webkitFilter="grayscale(100%)",n.style.opacity="0.6"),l.style.opacity="0"},!1)},e}();